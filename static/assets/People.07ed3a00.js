import{s as C}from"./request.e71a236e.js";import{u as q,_ as j,a as G}from"./upload.273546f8.js";import{_ as H,b as v,s as J,c as d,o as K,e as O,g as e,h as a,F as Q,E as p,l as m,f as k,C as X,D as Z}from"./index.794eb616.js";function ee(f){return C({url:"/people",method:"post",data:f})}function le(f){return C({url:"/people",method:"delete",params:{id:f}})}function ae(f){return C({url:"/people",method:"put",data:f})}function oe(f){return C({url:"/people",method:"get",params:f})}const te={slot:"footer",class:"dialog-footer"},ne={slot:"footer",class:"dialog-footer"},ue={__name:"People",setup(f){const _=v({pageNo:1,pageSize:10,year:""}),x=v([]),w=v(0),y=v(!1),u=v({}),b=v(!1),r=v({}),c=()=>{oe(_.value).then(t=>{t.code===200?(x.value=t.data.list,w.value=t.data.total||0):p.error(t.msg)}).catch(t=>{console.log(t)})},D=()=>{_.value={pageNo:1,pageSize:10,year:""},c()},h=t=>{_.value.pageSize=t,c()},E=t=>{_.value.pageNo=t,c()},B=t=>{r.value=t,b.value=!0},N=async t=>{await X.confirm("Confirm deletion?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).catch(n=>n)==="confirm"&&le(t).then(n=>{n.code===200?(c(),p.success("Delete success")):p.error("Delete failed")}).catch(n=>{console.log(n),p.error("Network error")})},T=()=>{ee(u.value).then(t=>{t.code===200?(c(),y.value=!1,p.success("Add success")):p.error("Add failed")})},S=()=>{ae(r.value).then(t=>{t.code===200?(c(),b.value=!1,p.success("Update success")):p.error("Update failed")})},M=async t=>{const l=new FormData;l.append("file",t.file);let n=await q(l);if(n.code!==200){p.error("Import failed");return}const V=Z.service({lock:!0,text:"Import data...",background:"rgba(0, 0, 0, 0.7)"});(await j({data:"people",file:n.data})).code===200?(p.success("Import success"),c()):p.error("Import failed"),V.close()},A=()=>{console.log("export"),G({data:"people"}).then(t=>{t.code===200?(window.open(t.data),p.success("Export success")):p.error("Export failed")})};return J(()=>{c()}),(t,l)=>{const n=d("el-input"),V=d("el-col"),s=d("el-button"),F=d("el-upload"),z=d("el-row"),L=d("el-header"),g=d("el-table-column"),$=d("el-table"),R=d("el-main"),P=d("el-pagination"),W=d("el-container"),i=d("el-form-item"),I=d("el-form"),U=d("el-dialog");return K(),O(Q,null,[e(W,{class:"el-container-fix"},{default:a(()=>[e(L,null,{default:a(()=>[e(z,{gutter:20},{default:a(()=>[e(V,{span:4},{default:a(()=>[e(n,{modelValue:_.value.year,"onUpdate:modelValue":l[0]||(l[0]=o=>_.value.year=o),placeholder:"Year"},null,8,["modelValue"])]),_:1}),e(V,{span:4},{default:a(()=>[e(s,{type:"primary",onClick:c},{default:a(()=>[m(" Search ")]),_:1}),e(s,{type:"info",onClick:D},{default:a(()=>[m(" Reset ")]),_:1}),e(s,{type:"primary",plain:"",onClick:l[1]||(l[1]=o=>y.value=!0)},{default:a(()=>[m(" Create ")]),_:1})]),_:1}),e(V,{span:1.5},{default:a(()=>[e(F,{ref:"uploadRef",class:"upload-demo","show-file-list":!1,"http-request":M},{trigger:a(()=>[e(s,{type:"success"},{default:a(()=>[m("Import")]),_:1})]),_:1},512)]),_:1},8,["span"]),e(V,{span:2},{default:a(()=>[e(s,{type:"warning",onClick:A},{default:a(()=>[m("Export")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,null,{default:a(()=>[e($,{data:x.value,height:"650",ref:"filterTable",border:!0,stripe:""},{default:a(()=>[e(g,{prop:"id",label:"id",width:"80"}),e(g,{prop:"year",label:"Year"}),e(g,{prop:"total",label:"Total"}),e(g,{prop:"man",label:"Man"}),e(g,{prop:"woman",label:"Woman"}),e(g,{prop:"city",label:"City"}),e(g,{prop:"village",label:"Village"}),e(g,{label:"Action",width:"300"},{default:a(o=>[e(s,{type:"warning",size:"small",icon:"Edit",onClick:Y=>B(o.row)},{default:a(()=>[m("Edit ")]),_:2},1032,["onClick"]),e(s,{size:"small",type:"danger",icon:"Delete",onClick:Y=>N(o.row.id)},{default:a(()=>[m("Delete ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(z,null,{default:a(()=>[e(P,{onSizeChange:h,onCurrentChange:E,"current-page":_.value.pageNo,"page-sizes":[10,20,50,100],"page-size":_.value.pageSize,total:w.value,layout:"total,prev, pager, next,jumper"},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(U,{title:"Add",modelValue:y.value,"onUpdate:modelValue":l[9]||(l[9]=o=>y.value=o),width:"30%"},{default:a(()=>[e(I,{model:u.value},{default:a(()=>[e(i,{prop:"year"},{default:a(()=>[e(n,{ref:"year",modelValue:u.value.year,"onUpdate:modelValue":l[2]||(l[2]=o=>u.value.year=o),size:"large",placeholder:"Year",name:"year",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:u.value.total,"onUpdate:modelValue":l[3]||(l[3]=o=>u.value.total=o),size:"large",placeholder:"Total",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"man"},{default:a(()=>[e(n,{modelValue:u.value.man,"onUpdate:modelValue":l[4]||(l[4]=o=>u.value.man=o),size:"large",placeholder:"Man",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:u.value.woman,"onUpdate:modelValue":l[5]||(l[5]=o=>u.value.woman=o),size:"large",placeholder:"Woman",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:u.value.city,"onUpdate:modelValue":l[6]||(l[6]=o=>u.value.city=o),size:"large",placeholder:"City",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:u.value.village,"onUpdate:modelValue":l[7]||(l[7]=o=>u.value.village=o),size:"large",placeholder:"Village",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),k("span",te,[e(s,{onClick:l[8]||(l[8]=o=>y.value=!1)},{default:a(()=>[m("Cancel")]),_:1}),e(s,{type:"primary",onClick:T},{default:a(()=>[m("Confirm")]),_:1})])]),_:1},8,["modelValue"]),e(U,{title:"Edit",modelValue:b.value,"onUpdate:modelValue":l[16]||(l[16]=o=>b.value=o),width:"30%"},{default:a(()=>[e(I,{model:r.value},{default:a(()=>[e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:r.value.total,"onUpdate:modelValue":l[10]||(l[10]=o=>r.value.total=o),size:"large",placeholder:"Total",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"man"},{default:a(()=>[e(n,{modelValue:r.value.man,"onUpdate:modelValue":l[11]||(l[11]=o=>r.value.man=o),size:"large",placeholder:"Man",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:r.value.woman,"onUpdate:modelValue":l[12]||(l[12]=o=>r.value.woman=o),size:"large",placeholder:"Woman",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:r.value.city,"onUpdate:modelValue":l[13]||(l[13]=o=>r.value.city=o),size:"large",placeholder:"City",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1}),e(i,{prop:"total"},{default:a(()=>[e(n,{modelValue:r.value.village,"onUpdate:modelValue":l[14]||(l[14]=o=>r.value.village=o),size:"large",placeholder:"Village",tabIndex:"-1","auto-complete":"on"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),k("span",ne,[e(s,{onClick:l[15]||(l[15]=o=>b.value=!1)},{default:a(()=>[m("Cancel")]),_:1}),e(s,{type:"primary",onClick:S},{default:a(()=>[m("Confirm")]),_:1})])]),_:1},8,["modelValue"])],64)}}},se=H(ue,[["__scopeId","data-v-60d5ab4c"]]);export{se as default};
